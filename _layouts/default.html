<div class="sidebar-menu" style="margin-top: 40px; text-align: left;">

  {% for category in site.categories %}
    <details open style="margin-bottom: 15px;">
      <summary style="font-weight: bold; cursor: pointer; font-size: 18px; list-style: none;">
        ðŸ“‚ {{ category[0] }}
      </summary>
      
      <div style="margin-left: 10px; margin-top: 10px; border-left: 2px solid #eee; padding-left: 10px;">
        
        {% assign category_posts = category[1] %}
        
        {% assign primary_tags_list = "" | split: "" %}
        {% for post in category_posts %}
          {% if post.tags.size > 0 %}
            {% assign primary_tags_list = primary_tags_list | push: post.tags[0] %}
          {% endif %}
        {% endfor %}
        {% assign unique_primary_tags = primary_tags_list | uniq | sort %}

        {% for tag_name in unique_primary_tags %}
          <details style="margin-bottom: 8px;">
            <summary style="cursor: pointer; color: #555; font-size: 15px;">
              # {{ tag_name }}
            </summary>
            
            <ul style="margin: 5px 0 10px 20px; padding: 0;">
              {% for post in category_posts %}
                {% if post.tags[0] == tag_name %}
                  <li style="list-style: none; margin-bottom: 4px;">
                    <a href="{{ post.url | relative_url }}" style="font-size: 13px; text-decoration: none; color: #0366d6;">
                      - {{ post.title }}
                    </a>
                  </li>
                {% endif %}
              {% endfor %}
            </ul>
          </details>
        {% endfor %}

      </div>
    </details>
  {% endfor %}

</div>